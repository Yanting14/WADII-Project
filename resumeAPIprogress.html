<!doctype html>

<html>

<head>
  <!-- <script src="https://unpkg.com/axios/dist/axios.js"></script> -->

  <title>Resume Crafting</title>

  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
  <!-- Vue 3: development -->
  <script src="https://unpkg.com/vue@next"></script>
  <!-- Axios -->
  <script src="https://unpkg.com/axios/dist/axios.js"></script>

  <style>
    /* Set the size of the div element that contains the map */
    .errorMsg {
      color: red;
      cursor: pointer;
      font-style: italic;
    }
  </style>
</head>




<body>
  <div id="app">
    <h1>Resume Crafting</h1>

    <div>
      <label for="query" class="form-label">Test</label>
      <input type="text" v-model="query" class="form-control">
      <!-- chg to keyup -->
      <button type="btn btn-primary" @click="doCheck">Go!</button>
    </div>

    <!-- error -->
    <div v-if="errors.length === 0 && checked" class="alert alert-success">
      <!-- link to new browser page for printing via href -->
      Thank you for your information, click here for your resume!
    </div>

    <!-- no error -->
    <div v-else>
      <div v-for="(error, index)" class="alert alert-danger">
        <p>{{ index + 1}}. Did you mean any of these:
          <span class="errorMsg" @click="applyCorrection(error.better)">
            <!-- if error.better exists, it will insert that, else, it displays the right -->
            {{ error.better '?' || 'Remove this word': error.bad}}
            <!-- need to acc if the words are repeated... -->
          </span>
        </p>
      </div>
    </div>
  </div>


  <!-- vue -->
  <script>
    const app = Vue.createApp({
      data() {
        return {
          query: 'funny cate',
          errors: [],
          checked: false, // Tracks whether the text was checked
          apiKey: '4W36qESsnhXoNOqa'

        }
      },
      methods: {
        // function 1: check
        doCheck() {
          this.checked = false; // Reset check status
          this.errors = []; // Clear previous errors

          axios.get('https://api.textgears.com/check.php', {
            params: {
              text: this.query,
              language: "en-GB",
              ai: true,
              key: this.apiKey
            }
          })
          .then(response=> {
            console.log(response.data)

            if(response.data && Array.isArray(respnse.data.errors)){
              this.errors = response.data.errors
            }else{
              this.checked = true // no error
            }
          })
          .catch(error => {
          console.error("API Error:", error) //console log errors
        });
        }, //end of function 1

        //function 2: display errors
        applyCorrection(bad,better){
          if(!better){
            let words = this.query.split(' ')
            words = words.filter(word => word !== bad)

            this.query = words.join(' ')
            this.query = this.query.trim()
            
          }
        }
      }
    })
    const vm = app.mount('#app');
  </script>






</body>

</html>